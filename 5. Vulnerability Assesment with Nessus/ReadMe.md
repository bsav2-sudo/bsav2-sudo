# 5. Vulnerability Assesment with Nessus and NMap

![What-Is-A-Vulnerability-Assessment](https://github.com/user-attachments/assets/df5194eb-7073-4bc2-b8a1-d054c25816c2)

### Skills Utilised

<code>Vulnerability Assesment</code> <code>Endpoints</code> <code>Nesuss</code> <code>Network</code> <code>Research</code> <code>CVE</code> <code>Vulnerability Scanner</code> <code>Network Vulnerabilities</code> <code>NMap</code> <code>Host Identification</code> <code>Network Scanning</code> <code>Open-Source</code>

## Overview

In this project - I will be using Tenable's Nessus and NMap to conduct as Vulnerability Assesment on my home network to discover where there are vulnerabilites in the network and also in endpoints. The aim of the project is to be able to complete a vulnerability assesment while creating a plan to address the vulnerabilities found in terms of risk. This project will focus on the Network and Host-Based Vulnerabilities however in future projects I hope to expand to Wireless vulnerabilities and more. So without further ado lets get started. 

## Nmap

One of my favourite tools for being able to perform network scanning is of course Nmap. Nmap is an open source utility used for doing network discovery and security auditing - it is one of the most used tools within the realm of Cybersecurity as it is easy to use and can be powerful when used correctly. In this project being able to use Nmap to discover hosts on my home network and also do other things such as OS detection and open ports of these hosts. So the first thing I'm going to do is run a scan using Nmap on my network.

One notable to mention is that in this project I'm going to be using Zenmap which is a GUI version of Nmpa - I prefer to use the GUI version as I find it easier to use and easier to define the parameters I want to set for the scan.

For this scan there are a few parameters I want to set to be able to get the best results from the scan as possible which are:

- Fragment the scan over a longer period of time - this will try to get passed some of the firewall features and rules
- Intense scan of the network - get as many open ports as it can find
- Be as silent as possible on the network so that the Firewall doesn't suspect a scan is taking place

To do this I am going to use the following command for Nmap:

<code>nmap -T4 -A -v -Pn 192.168.1.0/24</code> - Also known in Zenmap as Intense Scan, No Ping Profile

This will do the following:

- T4 - Agressive Time Template
- A - Enables OS Detection
- v - Verbose
- Pn - Disable Host Discovery

This will allow me to do a very sneaky scan on the network without gaining too much attention, so without further ado let's run it!

![Nmap Scan - Home Network](https://github.com/user-attachments/assets/5f8af2eb-e3c0-4ce0-be1b-34f3b775b009)

As you can see the scan is running and looking for all the open ports on the network while also doing OS detection.

And after around 15 mins the results are in...

![Detected Hosts](https://github.com/user-attachments/assets/9a193b91-d08f-4cbd-a153-900de09b0526)

> In total 11 hosts were detected at the time of the scan including TV's, IOT devices and Laptops/PC's

In total when the scan was completed there were 11 hosts that were up. And from the scan Nmap was able to find some good information about them, so lets take a look at some of them:

![Host - Most Open Ports](https://github.com/user-attachments/assets/201b38a7-9025-4e62-8ffb-22cc8ee58d2a)

The host with the most open ports on it was one of my IoT Devices - my Apple HomePod Mini. And looking a little further these were the ports that were open:

![BeanHome Ports](https://github.com/user-attachments/assets/8f900d0b-63b9-4d70-8ab1-eacbbf54c824)

As I can see - the ports that are open relate to the RTSP (Real Time Streaming Protocol), Port 53 for DNS and three other TCP ports in which two of them are wrapped. For an IoT device this is quite normal as the features of an Apple HomePod Mini mean it needs to communicate with more services to be able to operate.

Next - I want to take a look at my own lab laptop and see what Nmap has found for it:

![Laptop - Host Details](https://github.com/user-attachments/assets/609a1dd7-1952-4175-8d8f-5df73318f3c4)

![Personal Laptop](https://github.com/user-attachments/assets/0b1b2647-9a66-41fb-ae9d-180942895ed8)

One thing that is very notable from the beginning is that NMap was successful in being able to determine what OS my lab laptop was using - Windows 10 1607 - 11 23H2. What is also very useful to see is the open ports that are on my laptop which are:

- Microsoft Windows RPC
- Micorosft Windows netbios-ssn
- Microsoft-DS
- Splunkd httpd (I use this for my SIEM Solution)

Finally the last one I want to take a look at is my netowrk router just to see what services and open ports are running on it:

![Router - Open Ports](https://github.com/user-attachments/assets/9d1fad0d-4b33-4c4b-b4e3-e00fdf71ccea)

All of this is very useful to know as a Security audit as it allows me to see what services are running and may be vulnerable to attack. I can look at each service and see if my services are all up to date and don't have any reported vulnerabilities on them and make sure that services that do not need to be open can be closed.

## Nessus

Now that I have completed my NMap scan - I can now look at using Nessus to do a full scan of my network to see if it finds any vulnerabilities and report them back to me. Nessus is a very good tool for Vulnerability assesments as it provides a scoring on vulnerabilities to be able to determine which are the most riskiest and take action on them. Furthermore - Tennable can also provide a full report on each device it finds on the network. So to start I'm going to setup my Tenable account to get started:

![Scans Page](https://github.com/user-attachments/assets/661362c7-9f69-40ce-a2be-5183daccd71c)

Now I have access I can start to run a scan on the network - for this I am going to choose the Basic Network scan template adn tell Nessus to look for vulnerabilties and then fill out the scan details and then let it begin!

![Scan Start](https://github.com/user-attachments/assets/9cfcc99c-4d5e-42e6-8e1a-9971ce9674ae)

Once it is complete it will show the results:

![Scan Results](https://github.com/user-attachments/assets/528d4b12-887a-4eae-b2eb-dcfd28213995)

As you can see from the results - Nessus was able to find two hosts with some vulnerabilities - in which one of them has two medium risks and the others contain information so lets take a look at the medium risk vulnerabilities it found:

### SMB Signing not required

This vulnerability was found by Nessus in the scan and gives the following info on the vulnerability:

![Medium Risk](https://github.com/user-attachments/assets/5c4e33d5-d80f-47de-b169-916f6c83efd7)

Score: CVSS 5.3
Risk Factor: Medium
Description: Signing is not required on the remote SMB server. An unauthenticated, remote attacker can exploit this to conduct man-in-the-middle attacks against the SMB server.

Luckily Nessus also reports a solution on how to resolve this vulnerability in which it gives the following instructions:

"Enforce message signing in the host's configuration. On Windows, this is found in the policy setting 'Microsoft network server: Digitally sign communications (always)'. On Samba, the setting is called 'server signing'. See the 'see also' links for further details."

Looking on my personal laptop for this solution I was able to find it within the settings and make the relevant changes.

![Require Security Signature - Medium Risk ](https://github.com/user-attachments/assets/c3014353-d511-4243-acff-acf07f094004)

### SSL Certificate Cannot be trusted

Score: CVSS 6.5
Risk Factor Medium
Description: The server's X.509 certificate cannot be trusted.

Now with this issue I had to do some investigating to see what website didn't have the trusted SSL certificate - I found that the port that it was coming from port <code>8834</code> , going to the Command Prompt and running <code>netstat -ano</code> allowed me to see the PID (Process ID) this port was using - which I found to be <code>PID = 5824</code> - from their looking into the Task Manager I found PID 5824 - which was actually Nessus running...

![SSL Certificate - Nessus PID](https://github.com/user-attachments/assets/311b4777-7c79-4ffe-b362-65789f8cd161)

I am not worried about this as I know the process is Nessus however the fact it reported an invalid SSL certificate is always a good thing to look out for.

Now that I have seen what Medium risks are I can look a bit more to see what info Nessus found on the two hosts it found - what type of information did it pick up etc.

![iPhone Info Gathering ](https://github.com/user-attachments/assets/7d9ee4d6-5ca6-4643-bc7c-954b462d5d3a)

From my personal iPhone - I can see that Nessus was able to find some valuable information about my device including MAC Address, Device Type, OS Detection and Service Detection. For anyone trying to look into my network and see this device - they can get some valuable details to be able to reconnaisance and plan some attacks on the device such as known vulnerabilities within the services that are running, known OS vulnerabilities and more - removing access to this type of information can be very important in being able to secure my home network from outsiders and attack vectors.

## Conclusion

